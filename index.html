<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­å®¢ä½¬ç²¾å“çƒ˜åŸ¹ - è¨‚è³¼ç³»çµ±</title>
    <style>
        :root { --primary-brown: #5D4037; --soft-beige: #F9F7F2; --accent-gold: #C2A378; }
        body { font-family: sans-serif; background-color: var(--soft-beige); padding: 20px; }
        .container { max-width: 900px; margin: auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .header { text-align: center; margin-bottom: 20px; }
        .product-hero { text-align: center; margin-bottom: 20px; border: 1px solid #EEE; padding: 10px; border-radius: 10px; }
        .product-img { width: 100%; max-height: 600px; object-fit: contain; }
        .tab-container { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; }
        .tab { padding: 8px 20px; cursor: pointer; border: 1px solid var(--accent-gold); border-radius: 50px; color: var(--accent-gold); }
        .tab.active { background: var(--accent-gold); color: white; }
        .cart-section { display: grid; grid-template-columns: 1fr 300px; gap: 20px; margin-top: 30px; border-top: 2px solid #F0E6D6; padding-top: 20px; }
        .cart-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #EEE; }
        button { cursor: pointer; border-radius: 5px; border: none; }
        .btn-add { background: var(--primary-brown); color: white; padding: 10px 20px; width: 100%; }
        .btn-send { background: #27ae60; color: white; padding: 15px; width: 100%; font-size: 1.1em; }
        input, select { width: 100%; padding: 10px; margin: 5px 0 15px 0; border: 1px solid #DDD; border-radius: 5px; box-sizing: border-box; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h2>æ­å®¢ä½¬ç²¾å“çƒ˜åŸ¹</h2>
        <p>å®˜ç¶²è¨‚è³¼é€£å‹•ç³»çµ±</p>
    </div>

    <div class="tab-container">
        <div class="tab active" onclick="switchCategory('ç”Ÿåå¸')">æ—¥ç³»ç”Ÿåå¸</div>
        <div class="tab" onclick="switchCategory('ç±³é¦™èŠ±ç”Ÿ')">ç±³é¦™èŠ±ç”Ÿ</div>
        <div class="tab" onclick="switchCategory('æ›è€³å’–å•¡')">ç²¾å“æ›è€³</div>
    </div>

    <div class="product-hero">
        <img id="mainImg" src="" class="product-img">
    </div>

    <div style="background: #FFF; padding: 20px; border: 1px solid #F0E6D6; border-radius: 10px;">
        <label>é¸æ“‡å“é …å£å‘³</label>
        <select id="prodSel" onchange="updateUI()"></select>
        <label>æ•¸é‡</label>
        <input type="number" id="prodQty" value="1" min="1">
        <button class="btn-add" onclick="addToCart()">åŠ å…¥è³¼ç‰©è»Š</button>
    </div>

    <div class="cart-section">
        <div>
            <h3>ğŸ›’ è³¼ç‰©æ¸…å–®</h3>
            <div id="cartDisplay">ç›®å‰ç„¡å•†å“</div>
        </div>
        <div style="background: #FDFBF8; padding: 15px; border-radius: 10px;">
            <h3>æ”¶ä»¶è³‡è¨Š</h3>
            <input type="text" id="uName" placeholder="å§“å">
            <input type="tel" id="uPhone" placeholder="é›»è©±">
            <div style="font-size: 1.5em; color: #B22222; text-align: center; margin-bottom: 15px;">
                Total: $<span id="totalPrice">0</span>
            </div>
            <button class="btn-send" id="sendBtn" onclick="submitToExcel()">ç¢ºèªé€å‡ºè¨‚å–®</button>
        </div>
    </div>
</div>

<script>
    const products = {
        'ç”Ÿåå¸': [
            { name: 'èŠéº»æ²å¿ƒç”Ÿåå¸', price: 220, img: 'https://i.postimg.cc/0MZb87G7/sheng-tu-si.jpg' },
            { name: 'åŸå‘³ç”Ÿåå¸', price: 130, img: 'https://i.postimg.cc/0MZb87G7/sheng-tu-si.jpg' },
            { name: 'é»ƒé‡‘å…¨éº¥ç”Ÿåå¸', price: 130, img: 'https://i.postimg.cc/0MZb87G7/sheng-tu-si.jpg' },
            { name: 'è—ä¼å’–å•¡ç”Ÿåå¸', price: 160, img: 'https://i.postimg.cc/0MZb87G7/sheng-tu-si.jpg' },
            { name: 'è‰¾ç¾é»›å·§å…‹åŠ›ç”Ÿåå¸', price: 180, img: 'https://i.postimg.cc/0MZb87G7/sheng-tu-si.jpg' },
            { name: 'å®‡æ²»ç´…è±†ç”Ÿåå¸', price: 180, img: 'https://i.postimg.cc/0MZb87G7/sheng-tu-si.jpg' }
        ],
        'ç±³é¦™èŠ±ç”Ÿ': [
            { name: 'ç±³é¦™èŠ±ç”Ÿ (éº»è¾£é…¥)', price: 150, img: 'https://i.postimg.cc/S2VJycL8/mi-xiang-hua-sheng.jpg' },
            { name: 'ç±³é¦™èŠ±ç”Ÿ (ç™½ç±³é…¥)', price: 150, img: 'https://i.postimg.cc/S2VJycL8/mi-xiang-hua-sheng.jpg' },
            { name: 'ç±³é¦™èŠ±ç”Ÿ (é»‘ç±³é…¥)', price: 150, img: 'https://i.postimg.cc/S2VJycL8/mi-xiang-hua-sheng.jpg' },
            { name: 'ç±³é¦™èŠ±ç”Ÿ (ç´…éº¥é…¥)', price: 150, img: 'https://i.postimg.cc/S2VJycL8/mi-xiang-hua-sheng.jpg' }
        ],
        'æ›è€³å’–å•¡': [
            { name: 'ç¶“å…¸æ›¼å·´', price: 45, img: 'https://i.postimg.cc/nCGh449D/gua-er-jing-dian-man-ba.jpg' },
            { name: 'è—å±±é¢¨å‘³', price: 50, img: 'https://i.postimg.cc/mtygYY1t/gua-er-lan-shan-feng-wei.jpg' },
            { name: 'é™³å¹´é˜¿æ‹‰æ¯”å¡', price: 45, img: 'https://i.postimg.cc/BXBnTTP4/gua-er-chen-nian-a-la-bi-ka.jpg' },
            { name: 'é»ƒé‡‘æ›¼æ‘©é¢¨å‘³', price: 50, img: 'https://i.postimg.cc/6yfprr42/gua-er-huang-jin-man-mo-feng-wei.jpg' },
            { name: 'é»ƒé‡‘æ›¼ç‰¹å¯§', price: 55, img: 'https://i.postimg.cc/2V7SQQLy/gua-er-huang-jin-man-te-ning.jpg' }
        ]
    };

    let cart = [];
    let currentCat = 'ç”Ÿåå¸';

    function switchCategory(cat) {
        currentCat = cat;
        document.querySelectorAll('.tab').forEach(t => t.classList.toggle('active', t.innerText.includes(cat.slice(0,2))));
        const sel = document.getElementById('prodSel');
        sel.innerHTML = products[cat].map(p => `<option value="${p.name}" data-price="${p.price}" data-img="${p.img}">${p.name} - $${p.price}</option>`).join('');
        updateUI();
    }

    function updateUI() {
        const sel = document.getElementById('prodSel');
        document.getElementById('mainImg').src = sel.options[sel.selectedIndex].dataset.img;
    }

    function addToCart() {
        const sel = document.getElementById('prodSel');
        const name = sel.value;
        const price = parseInt(sel.options[sel.selectedIndex].dataset.price);
        const qty = parseInt(document.getElementById('prodQty').value);
        const exist = cart.find(i => i.name === name);
        if (exist) { exist.qty += qty; } else { cart.push({ name, price, qty }); }
        renderCart();
    }

    function renderCart() {
        const disp = document.getElementById('cartDisplay');
        if (cart.length === 0) { disp.innerHTML = "ç›®å‰ç„¡å•†å“"; document.getElementById('totalPrice').innerText = "0"; return; }
        let total = 0;
        disp.innerHTML = cart.map((item, idx) => {
            total += item.price * item.qty;
            return `<div class="cart-item"><span>${item.name} x ${item.qty}</span><span>$${item.price * item.qty} <button onclick="cart.splice(${idx},1);renderCart()" style="color:red">åˆªé™¤</button></span></div>`;
        }).join('');
        document.getElementById('totalPrice').innerText = total;
    }

    async function submitToExcel() {
        if (cart.length === 0) return alert("è«‹å…ˆåŠ å…¥å•†å“");
        const name = document.getElementById('uName').value;
        const phone = document.getElementById('uPhone').value;
        if (!name || !phone) return alert("è«‹å¡«å¯«å§“åèˆ‡é›»è©±");

        const btn = document.getElementById('sendBtn');
        btn.disabled = true; btn.innerText = "è¨‚å–®å‚³é€ä¸­...";

        const productDetails = cart.map(i => `${i.name}(${i.qty})`).join(', ');
        const webAppUrl = "https://script.google.com/macros/s/AKfycbyCOEZ-kExo0zKACfySu73BN_6YDJjMXovcCcY__h9v0NVXxpV1mhuZPm2lnvPCmtWf/exec";

        try {
            await fetch(webAppUrl, {
                method: "POST", mode: "no-cors",
                body: JSON.stringify({ name, phone, productName: productDetails, totalPrice: document.getElementById('totalPrice').innerText, payment: "å¾…ç¢ºèª" })
            });
            alert("ğŸ‰ è¨‚å–®å·²å‚³é€åˆ° Excelï¼");
            cart = []; renderCart();
        } catch (e) { alert("ç³»çµ±å‡ºéŒ¯ï¼Œè«‹æª¢æŸ¥ç¶²è·¯"); }
        finally { btn.disabled = false; btn.innerText = "ç¢ºèªé€å‡ºè¨‚å–®"; }
    }
    switchCategory('ç”Ÿåå¸');
</script>
</body>
</html>